---
title: The rename command
date: 2015-12-22 17:23:00 +0800
categories: [Linux]
tags: [command]
---

Linux 中 rename 命令可以对目录或文件进行改名，Sqoop会把已经完成传输的文件改名加上.COMPLETED后缀来区分是否需要处理，当我们做BUG复现调试时，需要再次传输这批文件，这时可以用文件改名去掉.COMPLETED后缀的方式实现，然而一个一个文件改名效率显然太低，rename命令可以支持批量改名

将所有子目录中符合*_2015-12-22_*.log.COMPLETED名称的文件名中的.log.COMPLETED改为.log

## 先看看目录结构及文件名规律

```bash
$ tree ./
./
├── task0001
...
│   ├── 12398374_2015-12-21_37652.log.COMPLETED
│   ├── 12398374_2015-12-21_38273.log.COMPLETED
│   ├── 13627779_2015-12-22_41826.log.COMPLETED
│   ├── 13627778_2015-12-22_37652.log.COMPLETED
│   ├── 18028345_2015-12-22_38273.log.COMPLETED
│   ├── 18028345_2015-12-22_41826.log.COMPLETED
...
├── task0002
...
│   ├── 12398374_2015-12-21_37652.log.COMPLETED
│   ├── 12398374_2015-12-21_38273.log.COMPLETED
│   ├── 13627779_2015-12-22_41826.log.COMPLETED
│   ├── 13627778_2015-12-22_37652.log.COMPLETED
│   ├── 18028345_2015-12-22_38273.log.COMPLETED
│   ├── 18028345_2015-12-22_41826.log.COMPLETED
...
```

可以看到同一天的文件分到不同文件夹，并且每个文件夹都有多天的数据，我只需要修改今天的数据让Sqoop重发今天的日志即可，因此命令行需要进行一些匹配过滤

## 执行改名命令
```bash
$ rename .log.COMPLETED .log */*_2015-12-22_*.log.COMPLETED
successful!
```

## 查看一下文件名是否更改正确
```bash
$ tree ./
./
├── task0001
...
│   ├── 12398374_2015-12-21_37652.log.COMPLETED
│   ├── 12398374_2015-12-21_38273.log.COMPLETED
│   ├── 13627779_2015-12-22_41826.log
│   ├── 13627778_2015-12-22_37652.log
│   ├── 18028345_2015-12-22_38273.log
│   ├── 18028345_2015-12-22_41826.log
...
├── task0002
...
│   ├── 12398374_2015-12-21_37652.log.COMPLETED
│   ├── 12398374_2015-12-21_38273.log.COMPLETED
│   ├── 13627779_2015-12-22_41826.log
│   ├── 13627778_2015-12-22_37652.log
│   ├── 18028345_2015-12-22_38273.log
│   ├── 18028345_2015-12-22_41826.log
...
```

执行成功！